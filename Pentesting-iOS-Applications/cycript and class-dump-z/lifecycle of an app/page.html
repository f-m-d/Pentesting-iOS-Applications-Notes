<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Lifecycle of an App</title>
</head><body><br/>
Come nel mondo del linguaggio C,<br/>
la funzione principale si chiama "main":<br/>
prende in input il numero di argomenti (<b>argc</b>)<br/>
e un array di puntatori a questi elementi (<b>*argv[]</b>)<br/>
<br/>
La funzione principale dell'app sembra chiamarsi<br/>
UIApplicationMain<br/>
<img src="1.png" /><br/>
<br/>
<img src="1 2.png" /><br/>
<br/>
<br/>
<br/>
Ok, cerchiamo di capire meglio<br/>
come funziona <b>delegation</b>.<br/>
<br/>
Link info generali:<br/>
<a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/_index.html">https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/_index.html<br/>
<br/>
</a>Link della spiegazione sulla Delegation:<br/>
<a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html#//apple_ref/doc/uid/TP40008195-CH14-SW1">https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html#//apple_ref/doc/uid/TP40008195-CH14-SW1<br/>
<br/>
<br/>
</a>In sintesti:<br/>
il delegate serve a gestire la risposta delle operazioni<br/>
che effettua l'utente.<br/>
Nel caso successivo, possiamo definire<br/>
che l'immagine non va chiusa anche se chiama il metodo<br/>
<b>windowsShouldClose():<br/>
<br/>
Il Delegate ottiene le funzioni con gli input<br/>
e sceglie cosa fare.<br/>
<br/>
</b><b>I</b>n questo modo possiamo scegliere<br/>
la nostra classe di delegation alla<br/>
variabile <b>"*delegateClassName"</b><br/>
<img src="1 3.png" /><br/>
<hr/><hr/><br/>
Dal punto di vista del Pentester,<br/>
vediamo cosa significa.<br/>
<br/>
<b>NB: L'app deve essere in foreground, col telefono unlocked!</b><br/>
<b>Questo perché se l'app va in background o col blocco schermo,<br/>
</b><b>l'app smette di essere runnata.</b><br/>
<br/>
<br/>
Se ricordiamo la funzione interna la main "UIApplicationMain",<br/>
possiamo sapere che la classe principale si chiama <b>UIApplication</b>.<br/>
<br/>
Essa offre un punto centralizzato dove controllare e gestire l'applicazione:<br/>
<b>deve esiste una solo istanza di UIApplication o di una sua sottoclasse!</b><br/>
<img src="1 4.png" /><br/>
<br/>
<br/>
<img src="1 5.png" /><br/>
<br/>
<br/>
Per chiamare l'istanza dell'applicazione,<br/>
ci basta usare cycript e chiamare il metodo <b>"sharedApplication"</b>,<br/>
contenuto della classe <b>UIApplication:</b><br/>
<br/>
<b>NB: In Objective-C, si usano le parentesi quadre<br/>
per chiamare i metodi!<br/>
</b><img src="1 6.png" /><b><br/>
</b><b><br/>
</b>Adesso abbiamo ottenuto una reference<br/>
a UIApplication.<br/>
Per salvarci la reference, possiamo<br/>
inserirla in una variabile:<br/>
NB: cycript di base lo fa già, creando una var chiamata <b>UIApp!</b><br/>
<img src="1 7.png" /><br/>
<img src="1 8.png" /><br/>
<br/>
<br/>
Per come sappiamo, le app hanno una classe di delegate.<br/>
Per saperla, basta chiamare la proprietà <b>"delegate".<br/>
</b><b>Questa ci ritorna il nome della classe-delegate e la sua reference.<br/>
</b>Infatti la classe di delegate dell'app si chiama così!<br/>
<img src="1 11.png" /><b><br/>
</b><img src="1 9.png" /><br/>
<img src="1 10.png" /><br/>
<br/>
<br/>
Le applicazioni, inoltre, hanno delle windows (mostrate o nascoste).<br/>
<b>Generalmente, una window è attiva mentre le altre sono nascoste.</b><br/>
NB: Le windows sono ordinate back to front.<br/>
<br/>
Per ottenere quella principale visibile, usa <b>keyWindow.</b><br/>
Per ottenere quelle nascoste, usa <b>windows<br/>
</b><b>(Vedi i comandi in precedenza, nella foto "UIApplications Tasks")<br/>
</b><img src="1 14.png" /><br/>
<img src="1 12.png" /><b><br/>
</b><b><img src="1 13.png" /><br/>
<br/>
<br/>
<br/>
</b><a href="https://developer.apple.com/documentation/uikit/uiwindow"><br/>
</a><a href="https://developer.apple.com/documentation/uikit/uiwindow">https://developer.apple.com/documentation/uikit/uiwindow#/apple_ref/occ/cl/UIWindow</a><br/>
Vedendo in precedenza, sappiamo che la keyWindow è un oggetto di tipo <b>UIWindow</b>.<br/>
Leggendo la documentazione, scopriamo che esiste una proprietà<br/>
che controlla cosa si trova all'interno della view (<b>rootViewController</b>)<br/>
<br/>
Controllando la prorpietà rootViewController della UIWindow scelta,<br/>
scopriamo il nome del View Controller!<br/>
<img src="1 15.png" /><br/>
<img src="1 16.png" /><br/>
<img src="1 17.png" /><br/>
<br/>
</body></html>